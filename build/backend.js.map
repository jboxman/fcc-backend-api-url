{"version":3,"sources":["webpack:///webpack/bootstrap 33d660555c0982c1f538","webpack:///./server/models/urlModel.js","webpack:///external \"express\"","webpack:///./~/validator/lib/util/assertString.js","webpack:///./~/validator/lib/util/merge.js","webpack:///./app.js","webpack:///./server/controllers/decodeController.js","webpack:///./server/controllers/encodeController.js","webpack:///./server/controllers/redirectController.js","webpack:///./server/controllers/statsController.js","webpack:///./~/validator/lib/isFQDN.js","webpack:///./~/validator/lib/isIP.js","webpack:///./~/validator/lib/isURL.js","webpack:///external \"body-parser\"","webpack:///external \"object-assign\"","webpack:///external \"redis\"","webpack:///./prodSrc.js"],"names":["client","config","getClient","getCount","getRecent","saveUrl","getUrl","maxKeyLength","redis_ds_URL","redis_ds_COUNT","redis_ds_RECENT","fn","get","err","reply","lrange","url","protocols","doUpdate","watch","count","process","nextTick","key","toString","compositeKey","console","log","multi","incr","lpush","set","exec","id","parseInt","length","isNaN","app","port","env","PORT","use","static","cwd","json","req","res","next","status","send","error","stack","render","server","listen","createClient","model","router","Router","param","v","post","body","shortUrl","redirect","recentUrls","require","default"],"mappings":";;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA,YAAI;AACJ;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;;;;kBCpDe,YAA+B;AAAA,mEAAJ,EAAI;;AAAA,yBAArBA,MAAqB;AAAA,MAArBA,MAAqB,+BAAZ,IAAY;;AAC5C;AACE,8BAAaC,MAAb,EAAqB,EAACD,cAAD,EAArB;AACF;AACA,SAAO;AACLE,wBADK;AAELC,sBAFK;AAGLC,wBAHK;AAILC,oBAJK;AAKLC;AALK,GAAP;AAOD,C;;AArBD;;;;AACA;;;;;;AAEA,IAAMC,eAAe,CAArB;AACA,IAAMC,eAAe,QAArB;AACA,IAAMC,iBAAiB,UAAvB;AACA,IAAMC,kBAAkB,WAAxB;;AAEA,IAAMT,SAAS,EAACD,QAAQ,IAAT,EAAf;;AAeA,SAASE,SAAT,GAAqB;AACnB,SAAOD,OAAOD,MAAd;AACD;;AAED,SAASG,QAAT,CAAkBQ,EAAlB,EAAsB;AAAA,MACbX,MADa,GACHC,MADG,CACbD,MADa;;AAEpBA,SAAOY,GAAP,CAAWH,cAAX,EAA2B,UAACI,GAAD,EAAMC,KAAN,EAAgB;AACzCH,OAAGG,KAAH;AACD,GAFD;AAGD;;AAED,SAASV,SAAT,CAAmBO,EAAnB,EAAuB;AAAA,MACdX,MADc,GACJC,MADI,CACdD,MADc;;AAErBA,SAAOe,MAAP,CAAcL,eAAd,EAA+B,CAA/B,EAAkC,CAAlC,EAAqC,UAACG,GAAD,EAAMC,KAAN,EAAgB;AACnDH,OAAGG,KAAH;AACD,GAFD;AAGD;;AAED,SAAST,OAAT,CAAiBW,GAAjB,EAAsBL,EAAtB,EAA0B;AAAA,MACjBX,MADiB,GACPC,MADO,CACjBD,MADiB;;;AAGxB,MAAG,CAAC,qBAAMgB,GAAN,EAAW,EAACC,WAAW,CAAC,MAAD,EAAS,OAAT,CAAZ,EAAX,CAAJ,EAAgD;AAC9CN,OAAG,IAAH;AACA;AACD;;AAEH;AACA;;AAEEO;AACA,WAASA,QAAT,GAAoB;AAClBlB,WAAOmB,KAAP,CAAaV,cAAb;AACAT,WAAOY,GAAP,CAAWH,cAAX,EAA2B,UAACI,GAAD,EAAMO,KAAN,EAAgB;AACzC,UAAGP,GAAH,EAAQ;AACNQ,gBAAQC,QAAR,CAAiBJ,QAAjB;AACD,OAFD,MAGK;AAAA;AACH;AACA;AACA,cAAMK,MAAM,CAAC,CAACH,SAAS,IAAV,IAAkB,CAAnB,EAAsBI,QAAtB,CAA+B,EAA/B,CAAZ;AACA,cAAMC,eAAkBjB,YAAlB,SAAkCe,GAAxC;AACAG,kBAAQC,GAAR,CAAYF,YAAZ;AACAC,kBAAQC,GAAR,CAAYJ,GAAZ;AACAvB,iBAAO4B,KAAP,GACGC,IADH,CACQpB,cADR,EAEGqB,KAFH,CAESpB,eAFT,EAE0BM,GAF1B,EAGGe,GAHH,CAGON,YAHP,EAGqBT,GAHrB,EAIGgB,IAJH,CAIQ,UAACnB,GAAD,EAAMC,KAAN,EAAgB;AACpB;AACA;AACA,gBAAG,OAAOA,KAAP,IAAgB,MAAnB,EAA2B;AACzBO,sBAAQC,QAAR,CAAiBJ,QAAjB;AACD,aAFD,MAGK;AACHP,iBAAGY,GAAH,EAAQT,KAAR;AACD;AACF,WAbH;AAPG;AAqBJ;AACF,KA1BD;AA2BD;AACF;;AAED,SAASR,MAAT,CAAgBiB,GAAhB,EAAqBZ,EAArB,EAAyB;AAAA,MAChBX,MADgB,GACNC,MADM,CAChBD,MADgB;AAEvB;AACA;;AACA,MAAMiC,KAAKC,SAASX,IAAIY,MAAJ,GAAa5B,YAAb,GAA4B,GAA5B,GAAkCgB,GAA3C,EAAgD,EAAhD,CAAX;AACA,MAAGa,MAAMH,EAAN,CAAH,EAAc;AACZtB,OAAG,IAAH;AACD;;AAEDX,SAAOY,GAAP,CAAcJ,YAAd,SAA8Be,GAA9B,EAAqC,UAACV,GAAD,EAAMC,KAAN,EAAgB;AACnDH,OAAGG,KAAH;AACD,GAFD;AAGD,C;;;;;;ACjGD,oC;;;;;;;ACAA;;AAEA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,oC;;;;;;;ACXA;;AAEA;AACA;AACA,CAAC;AACD;AACA;AACA,oEAAoE;AACpE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oC;;;;;;;;;;;;;kBCCe,YAAW;AACxB,MAAMuB,MAAM,wBAAZ;;AAEA,MAAMC,OAAOjB,QAAQkB,GAAR,CAAYC,IAAZ,IAAoB,IAAjC;;AAEA;AACAH,MAAII,GAAJ,CAAQ,kBAAQC,MAAR,CAAkBrB,QAAQsB,GAAR,EAAlB,aAAR;;AAEAN,MAAII,GAAJ,CAAQ,qBAAWG,IAAX,EAAR;;AAEAP,MAAII,GAAJ,CAAQ,GAAR;;AAEA;AACAJ,MAAII,GAAJ,CAAQ,MAAR;AACAJ,MAAII,GAAJ,CAAQ,MAAR;AACAJ,MAAII,GAAJ,CAAQ,MAAR;;AAEAJ,MAAII,GAAJ,CAAQ,UAASI,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AAC/BD,QAAIE,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,WAArB;AACD,GAFD;;AAIAZ,MAAII,GAAJ,CAAQ,UAAS5B,GAAT,EAAcgC,GAAd,EAAmBC,GAAnB,EAAwBC,IAAxB,EAA8B;AACpCrB,YAAQwB,KAAR,CAAcrC,IAAIsC,KAAlB;AACAL,QAAIE,MAAJ,CAAW,GAAX,EAAgBI,MAAhB,CAAuB,OAAvB;AACD,GAHD;;AAKA,MAAMC,SAAShB,IAAIiB,MAAJ,CAAWhB,IAAX,EAAiB;AAAA,WAAMZ,QAAQC,GAAR,mBAA4BW,IAA5B,CAAN;AAAA,GAAjB,CAAf;AACA,SAAOe,MAAP;AACD,C;;AA9CD;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;;;AAEA;AACA;AACA,IAAMrD,SAAS,gBAAMuD,YAAN,EAAf;AACA,IAAMC,QAAQ,wBAAS,EAACxD,cAAD,EAAT,CAAd;;AAEA;AACA;AA6BC,C;;;;;;;;;;;;;AC9CD;;;;AAEA;;;;;;AAEA,IAAMyD,SAAS,kBAAQC,MAAR,EAAf;AACA,IAAMF,QAAQ,yBAAd;;AAEAC,OAAOE,KAAP,CAAa,KAAb,EAAoB,UAACd,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAiBxB,GAAjB,EAAyB;AAC3C,MAAGA,GAAH,EACEsB,IAAItB,GAAJ,GAAUA,GAAV;AACFwB;AACD,CAJD;;AAMAU,OAAO7C,GAAP,CAAW,aAAX,EAA0B,gBAAQkC,GAAR,EAAgB;AAAA,MAAdvB,GAAc,QAAdA,GAAc;;AACxC,MAAG,CAACA,GAAJ,EAAS;AACPuB,QAAIE,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,kBAArB;AACA;AACD;AACDO,QAAMlD,MAAN,CAAaiB,GAAb,EAAkB,UAACqC,CAAD,EAAO;AACvBd,QAAIE,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AACnB5B,WAAK4C;AADc,KAArB;AAGD,GAJD;AAKD,CAVD;;kBAYeH,M;;;;;;;;;;;;;ACzBf;;;;AAEA;;;;;;AAEA,IAAMA,SAAS,kBAAQC,MAAR,EAAf;AACA,IAAMF,QAAQ,yBAAd;;AAEAC,OAAOI,IAAP,CAAY,OAAZ,EAAqB,UAAChB,GAAD,EAAMC,GAAN,EAAc;AAAA,MAC1B9B,GAD0B,GACnB6B,IAAIiB,IADe,CAC1B9C,GAD0B;;AAEjC,MAAG,CAACA,GAAJ,EAAS;AACP8B,QAAIE,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,kBAArB;AACA;AACD;AACDO,QAAMnD,OAAN,CAAcW,GAAd,EAAmB,UAAC4C,CAAD,EAAO;AACxBd,QAAIE,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AACnBrB,WAAKqC,CADc;AAEnBG,2CAAmCH;AAFhB,KAArB;AAID,GALD;AAMD,CAZD;;AAcA;;;;;;;;;;;;kBAYeH,M;;;;;;;;;;;;;ACjCf;;;;AAEA;;;;;;AAEA,IAAMA,SAAS,kBAAQC,MAAR,EAAf;AACA,IAAMF,QAAQ,yBAAd;;AAEA;AACAC,OAAOE,KAAP,CAAa,KAAb,EAAoB,UAACd,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAiBxB,GAAjB,EAAyB;AAC3CG,UAAQC,GAAR,CAAYJ,GAAZ;AACA,MAAGA,GAAH,EACEsB,IAAItB,GAAJ,GAAUA,GAAV;AACFwB;AACD,CALD;;AAOAU,OAAO7C,GAAP,CAAW,OAAX,EAAoB,gBAAQkC,GAAR,EAAgB;AAAA,MAAdvB,GAAc,QAAdA,GAAc;;AAClC,MAAG,CAACA,GAAJ,EAAS;AACPuB,QAAIE,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,WAArB;AACA;AACD;AACDO,QAAMlD,MAAN,CAAaiB,GAAb,EAAkB,UAACqC,CAAD,EAAO;AACvBd,QAAIkB,QAAJ,CAAaJ,CAAb;AACD,GAFD;AAGD,CARD;;kBAUeH,M;;;;;;;;;;;;;ACzBf;;;;AAEA;;;;;;AAEA,IAAMA,SAAS,kBAAQC,MAAR,EAAf;AACA,IAAMF,QAAQ,yBAAd;;AAEAC,OAAO7C,GAAP,CAAW,SAAX,EAAsB,UAACiC,GAAD,EAAMC,GAAN,EAAc;AAClCU,QAAMpD,SAAN,CAAgB,aAAK;AACnB0C,QAAIE,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB;AACnBqB,kBAAYL;AADO,KAArB;AAGD,GAJD;AAKD,CAND;;kBAQeH,M;;;;;;;ACff;;AAEA;AACA;AACA,CAAC;AACD;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,GAAG,aAAa,GAAG;AACnE;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oC;;;;;;;ACxDA;;AAEA;AACA;AACA,CAAC;AACD;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,sBAAsB,IAAI,OAAO,IAAI,OAAO,IAAI,OAAO,IAAI;AAC3D,2BAA2B,IAAI;;AAE/B;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA,mCAAmC;;AAEnC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oC;;;;;;;AChFA;;AAEA;AACA;AACA,CAAC;AACD;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,iBAAiB,oBAAoB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,oC;;;;;;AC7IA,wC;;;;;;ACAA,0C;;;;;;ACAA,kC;;;;;;;;;ACAA,mBAAAS,CAAQ,CAAR,EAAoBC,OAApB,G","file":"backend.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmory imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmory exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tObject.defineProperty(exports, name, {\n \t\t\tconfigurable: false,\n \t\t\tenumerable: true,\n \t\t\tget: getter\n \t\t});\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 15);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 33d660555c0982c1f538","import objectAssign from 'object-assign';\nimport isURL from 'validator/lib/isURL';\n\nconst maxKeyLength = 7;\nconst redis_ds_URL = 'ds_URL';\nconst redis_ds_COUNT = 'ds_COUNT';\nconst redis_ds_RECENT = 'ds_RECENT';\n\nconst config = {client: null};\n\nexport default function({client = null} = {}) {\n  //if(!config.client) {\n    objectAssign(config, {client});\n  //}\n  return {\n    getClient,\n    getCount,\n    getRecent,\n    saveUrl,\n    getUrl\n  }\n}\n\nfunction getClient() {\n  return config.client;\n}\n\nfunction getCount(fn) {\n  const {client} = config;\n  client.get(redis_ds_COUNT, (err, reply) => {\n    fn(reply);\n  });\n}\n\nfunction getRecent(fn) {\n  const {client} = config;\n  client.lrange(redis_ds_RECENT, 0, 9, (err, reply) => {\n    fn(reply);\n  });\n}\n\nfunction saveUrl(url, fn) {\n  const {client} = config;\n\n  if(!isURL(url, {protocols: ['http', 'https']})) {\n    fn(null);\n    return;\n  }\n\n// Perform optimistic locking with retry\n// http://stackoverflow.com/questions/29757935/redis-using-incr-value-in-a-transaction\n\n  doUpdate();\n  function doUpdate() {\n    client.watch(redis_ds_COUNT);\n    client.get(redis_ds_COUNT, (err, count) => {\n      if(err) {\n        process.nextTick(doUpdate);\n      }\n      else {\n        // Force this to 1,000 if count is undefined?\n        // http://stackoverflow.com/questions/9542726/is-it-possible-to-base-36-encode-with-javascript-jquery\n        const key = ((count || 1000) + 1).toString(36);\n        const compositeKey = `${redis_ds_URL}:${key}`;\n        console.log(compositeKey);\n        console.log(key);\n        client.multi()\n          .incr(redis_ds_COUNT)\n          .lpush(redis_ds_RECENT, url)\n          .set(compositeKey, url)\n          .exec((err, reply) => {\n            // Will return null if WATCH fails\n            // http://redis.io/commands/exec\n            if(typeof reply == 'null') {\n              process.nextTick(doUpdate);\n            }\n            else {\n              fn(key, reply);\n            }\n          });\n      }\n    });\n  }\n}\n\nfunction getUrl(key, fn) {\n  const {client} = config;\n  // Sanity check. Should decode to an integer.\n  // http://stackoverflow.com/questions/9542726/is-it-possible-to-base-36-encode-with-javascript-jquery\n  const id = parseInt(key.length > maxKeyLength ? '^' : key, 36);\n  if(isNaN(id)) {\n    fn(null);\n  }\n\n  client.get(`${redis_ds_URL}:${key}`, (err, reply) => {\n    fn(reply);\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/urlModel.js","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 1\n// module chunks = 0","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = assertString;\nfunction assertString(input) {\n  if (typeof input !== 'string') {\n    throw new TypeError('This library (validator.js) validates strings only');\n  }\n}\nmodule.exports = exports['default'];\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/validator/lib/util/assertString.js\n// module id = 2\n// module chunks = 0","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = merge;\nfunction merge() {\n  var obj = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n  var defaults = arguments[1];\n\n  for (var key in defaults) {\n    if (typeof obj[key] === 'undefined') {\n      obj[key] = defaults[key];\n    }\n  }\n  return obj;\n}\nmodule.exports = exports['default'];\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/validator/lib/util/merge.js\n// module id = 3\n// module chunks = 0","import express from 'express';\nimport redis from 'redis';\nimport bodyParser from 'body-parser';\n\nimport encodeController from './server/controllers/encodeController';\nimport decodeController from './server/controllers/decodeController';\nimport statsController from './server/controllers/statsController';\nimport redirectController from './server/controllers/redirectController';\n\nimport urlModel from './server/models/urlModel';\n\n// This will need a specific string for heroku\n// var client = require('redis').createClient(process.env.REDIS_URL);\nconst client = redis.createClient();\nconst model = urlModel({client});\n\n// For testing:\n// https://glebbahmutov.com/blog/how-to-correctly-unit-test-express-server/\nexport default function() {\n  const app = express();\n\n  const port = process.env.PORT || 3100;\n\n  // __dirname is '/' after babel\n  app.use(express.static(`${process.cwd()}/public`));\n\n  app.use(bodyParser.json());\n\n  app.use('/', redirectController);\n\n  // Import other functions\n  app.use('/api', statsController);\n  app.use('/api', encodeController);\n  app.use('/api', decodeController);\n\n  app.use(function(req, res, next) {\n    res.status(404).send('Not Found');\n  });\n\n  app.use(function(err, req, res, next) {\n    console.error(err.stack);\n    res.status(500).render('error');\n  });\n\n  const server = app.listen(port, () => console.log(`Listening on ${port}`));\n  return server;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./app.js","import express from 'express';\n\nimport urlModelSetup from '../models/urlModel';\n\nconst router = express.Router();\nconst model = urlModelSetup();\n\nrouter.param('key', (req, res, next, key) => {\n  if(key)\n    req.key = key;\n  next();\n});\n\nrouter.get('/fetch/:key', ({key}, res) => {\n  if(!key) {\n    res.status(400).send('Invalid API call');\n    return;\n  }\n  model.getUrl(key, (v) => {\n    res.status(200).json({\n      url: v\n    });\n  });\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/decodeController.js","import express from 'express';\n\nimport urlModelSetup from '../models/urlModel';\n\nconst router = express.Router();\nconst model = urlModelSetup();\n\nrouter.post('/save', (req, res) => {\n  const {url} = req.body;\n  if(!url) {\n    res.status(400).send('Invalid API call');\n    return;\n  }\n  model.saveUrl(url, (v) => {\n    res.status(200).json({\n      key: v,\n      shortUrl: `http://localhost:3100/${v}`\n    });\n  });\n});\n\n/*\nrouter.get('/saveUrl/:url', ({url}, res) => {\n  if(!url) {\n    res.status(400).send('Invalid API call');\n    return;\n  }\n  model.saveUrl(url, (v) => {\n    res.status(200).send(v);\n  });\n});\n*/\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/encodeController.js","import express from 'express';\n\nimport urlModelSetup from '../models/urlModel';\n\nconst router = express.Router();\nconst model = urlModelSetup();\n\n// Perform validation\nrouter.param('key', (req, res, next, key) => {\n  console.log(key);\n  if(key)\n    req.key = key;\n  next();\n});\n\nrouter.get('/:key', ({key}, res) => {\n  if(!key) {\n    res.status(404).send('Not Found');\n    return;\n  }\n  model.getUrl(key, (v) => {\n    res.redirect(v);\n  });\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/redirectController.js","import express from 'express';\n\nimport urlModelSetup from '../models/urlModel';\n\nconst router = express.Router();\nconst model = urlModelSetup();\n\nrouter.get('/recent', (req, res) => {\n  model.getRecent(v => {\n    res.status(200).json({\n      recentUrls: v\n    });\n  });\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/statsController.js","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = isFDQN;\n\nvar _assertString = require('./util/assertString');\n\nvar _assertString2 = _interopRequireDefault(_assertString);\n\nvar _merge = require('./util/merge');\n\nvar _merge2 = _interopRequireDefault(_merge);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar default_fqdn_options = {\n  require_tld: true,\n  allow_underscores: false,\n  allow_trailing_dot: false\n};\n\nfunction isFDQN(str, options) {\n  (0, _assertString2.default)(str);\n  options = (0, _merge2.default)(options, default_fqdn_options);\n\n  /* Remove the optional trailing dot before checking validity */\n  if (options.allow_trailing_dot && str[str.length - 1] === '.') {\n    str = str.substring(0, str.length - 1);\n  }\n  var parts = str.split('.');\n  if (options.require_tld) {\n    var tld = parts.pop();\n    if (!parts.length || !/^([a-z\\u00a1-\\uffff]{2,}|xn[a-z0-9-]{2,})$/i.test(tld)) {\n      return false;\n    }\n  }\n  for (var part, i = 0; i < parts.length; i++) {\n    part = parts[i];\n    if (options.allow_underscores) {\n      part = part.replace(/_/g, '');\n    }\n    if (!/^[a-z\\u00a1-\\uffff0-9-]+$/i.test(part)) {\n      return false;\n    }\n    if (/[\\uff01-\\uff5e]/.test(part)) {\n      // disallow full-width chars\n      return false;\n    }\n    if (part[0] === '-' || part[part.length - 1] === '-') {\n      return false;\n    }\n  }\n  return true;\n}\nmodule.exports = exports['default'];\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/validator/lib/isFQDN.js\n// module id = 9\n// module chunks = 0","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = isIP;\n\nvar _assertString = require('./util/assertString');\n\nvar _assertString2 = _interopRequireDefault(_assertString);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar ipv4Maybe = /^(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})$/;\nvar ipv6Block = /^[0-9A-F]{1,4}$/i;\n\nfunction isIP(str) {\n  var version = arguments.length <= 1 || arguments[1] === undefined ? '' : arguments[1];\n\n  (0, _assertString2.default)(str);\n  version = String(version);\n  if (!version) {\n    return isIP(str, 4) || isIP(str, 6);\n  } else if (version === '4') {\n    if (!ipv4Maybe.test(str)) {\n      return false;\n    }\n    var parts = str.split('.').sort(function (a, b) {\n      return a - b;\n    });\n    return parts[3] <= 255;\n  } else if (version === '6') {\n    var blocks = str.split(':');\n    var foundOmissionBlock = false; // marker to indicate ::\n\n    // At least some OS accept the last 32 bits of an IPv6 address\n    // (i.e. 2 of the blocks) in IPv4 notation, and RFC 3493 says\n    // that '::ffff:a.b.c.d' is valid for IPv4-mapped IPv6 addresses,\n    // and '::a.b.c.d' is deprecated, but also valid.\n    var foundIPv4TransitionBlock = isIP(blocks[blocks.length - 1], 4);\n    var expectedNumberOfBlocks = foundIPv4TransitionBlock ? 7 : 8;\n\n    if (blocks.length > expectedNumberOfBlocks) {\n      return false;\n    }\n    // initial or final ::\n    if (str === '::') {\n      return true;\n    } else if (str.substr(0, 2) === '::') {\n      blocks.shift();\n      blocks.shift();\n      foundOmissionBlock = true;\n    } else if (str.substr(str.length - 2) === '::') {\n      blocks.pop();\n      blocks.pop();\n      foundOmissionBlock = true;\n    }\n\n    for (var i = 0; i < blocks.length; ++i) {\n      // test for a :: which can not be at the string start/end\n      // since those cases have been handled above\n      if (blocks[i] === '' && i > 0 && i < blocks.length - 1) {\n        if (foundOmissionBlock) {\n          return false; // multiple :: in address\n        }\n        foundOmissionBlock = true;\n      } else if (foundIPv4TransitionBlock && i === blocks.length - 1) {\n        // it has been checked before that the last\n        // block is a valid IPv4 address\n      } else if (!ipv6Block.test(blocks[i])) {\n        return false;\n      }\n    }\n    if (foundOmissionBlock) {\n      return blocks.length >= 1;\n    }\n    return blocks.length === expectedNumberOfBlocks;\n  }\n  return false;\n}\nmodule.exports = exports['default'];\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/validator/lib/isIP.js\n// module id = 10\n// module chunks = 0","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = isURL;\n\nvar _assertString = require('./util/assertString');\n\nvar _assertString2 = _interopRequireDefault(_assertString);\n\nvar _isFQDN = require('./isFQDN');\n\nvar _isFQDN2 = _interopRequireDefault(_isFQDN);\n\nvar _isIP = require('./isIP');\n\nvar _isIP2 = _interopRequireDefault(_isIP);\n\nvar _merge = require('./util/merge');\n\nvar _merge2 = _interopRequireDefault(_merge);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar default_url_options = {\n  protocols: ['http', 'https', 'ftp'],\n  require_tld: true,\n  require_protocol: false,\n  require_host: true,\n  require_valid_protocol: true,\n  allow_underscores: false,\n  allow_trailing_dot: false,\n  allow_protocol_relative_urls: false\n};\n\nvar wrapped_ipv6 = /^\\[([^\\]]+)\\](?::([0-9]+))?$/;\n\nfunction isRegExp(obj) {\n  return Object.prototype.toString.call(obj) === '[object RegExp]';\n}\n\nfunction checkHost(host, matches) {\n  for (var i = 0; i < matches.length; i++) {\n    var match = matches[i];\n    if (host === match || isRegExp(match) && match.test(host)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction isURL(url, options) {\n  (0, _assertString2.default)(url);\n  if (!url || url.length >= 2083 || /\\s/.test(url)) {\n    return false;\n  }\n  if (url.indexOf('mailto:') === 0) {\n    return false;\n  }\n  options = (0, _merge2.default)(options, default_url_options);\n  var protocol = void 0,\n      auth = void 0,\n      host = void 0,\n      hostname = void 0,\n      port = void 0,\n      port_str = void 0,\n      split = void 0,\n      ipv6 = void 0;\n\n  split = url.split('#');\n  url = split.shift();\n\n  split = url.split('?');\n  url = split.shift();\n\n  split = url.split('://');\n  if (split.length > 1) {\n    protocol = split.shift();\n    if (options.require_valid_protocol && options.protocols.indexOf(protocol) === -1) {\n      return false;\n    }\n  } else if (options.require_protocol) {\n    return false;\n  } else if (options.allow_protocol_relative_urls && url.substr(0, 2) === '//') {\n    split[0] = url.substr(2);\n  }\n  url = split.join('://');\n\n  split = url.split('/');\n  url = split.shift();\n\n  if (url === '' && !options.require_host) {\n    return true;\n  }\n\n  split = url.split('@');\n  if (split.length > 1) {\n    auth = split.shift();\n    if (auth.indexOf(':') >= 0 && auth.split(':').length > 2) {\n      return false;\n    }\n  }\n  hostname = split.join('@');\n\n  port_str = ipv6 = null;\n  var ipv6_match = hostname.match(wrapped_ipv6);\n  if (ipv6_match) {\n    host = '';\n    ipv6 = ipv6_match[1];\n    port_str = ipv6_match[2] || null;\n  } else {\n    split = hostname.split(':');\n    host = split.shift();\n    if (split.length) {\n      port_str = split.join(':');\n    }\n  }\n\n  if (port_str !== null) {\n    port = parseInt(port_str, 10);\n    if (!/^[0-9]+$/.test(port_str) || port <= 0 || port > 65535) {\n      return false;\n    }\n  }\n\n  if (!(0, _isIP2.default)(host) && !(0, _isFQDN2.default)(host, options) && (!ipv6 || !(0, _isIP2.default)(ipv6, 6)) && host !== 'localhost') {\n    return false;\n  }\n\n  host = host || ipv6;\n\n  if (options.host_whitelist && !checkHost(host, options.host_whitelist)) {\n    return false;\n  }\n  if (options.host_blacklist && checkHost(host, options.host_blacklist)) {\n    return false;\n  }\n\n  return true;\n}\nmodule.exports = exports['default'];\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/validator/lib/isURL.js\n// module id = 11\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"object-assign\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"object-assign\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"redis\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"redis\"\n// module id = 14\n// module chunks = 0","require('./app.js').default();\n\n\n\n// WEBPACK FOOTER //\n// ./prodSrc.js"],"sourceRoot":""}